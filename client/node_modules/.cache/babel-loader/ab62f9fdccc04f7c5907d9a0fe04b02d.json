{"ast":null,"code":"import _slicedToArray from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6;import{Button,Card,Dialog,DialogActions,DialogTitle,Divider,List,ListItem,ListItemText,makeStyles,Typography,withStyles}from'@material-ui/core';import React from'react';import styled from'styled-components';import DeleteIcon from'@material-ui/icons/Delete';import AddIcon from'@material-ui/icons/Add';import Popup from'../Popup';import ActivityForm from'../ActivityComponents/ActivityForm';import{useState}from'react';import ActivityCard from'../ActivityComponents/ActivityCard';import{useEffect}from'react';import axios from'../../Axios';import{UserContext}from'../../UserContext';import{useContext}from'react';import ActivityInformation from'../ActivityComponents/ActivityInformation';import UserAvatar from'../UserAvatar';import GroupLeaderboard from'../LeaderboardComponents/GroupLeaderboard';import config from'../../Config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StyledHeader=styled.h2(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    text-align: center;\\n    font-size: 30px;\\n\"])));var StyledParagraph=styled.p(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    font-size: 10px;\\n\"])));var FeedContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    margin-left: 20px;\\n    min-height: 60%;\\n\"])));var StyledCard=withStyles({root:{marginBottom:'1rem',marginLeft:'1rem',marginTop:'1rem',minHeigth:'60%'}})(Card);var ActivityDiv=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n    margin: 5%;\\n    width: 50%;\\n    height: 60vh;\\n\"])));var TransformDiv=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n    transition: transform 450ms;\\n    min-width: 200px;\\n    max-width: 20%;\\n    max-height: 20%;\\n    margin-top: 5%;\\n    margin-bottom: 11rem;\\n\\n    :hover {\\n        transform: scale(1.08);\\n        cursor: pointer;\\n    }\\n\"])));var StyledButtons=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n    display: flex;\\n    padding: 1rem;\\n    justify-content: center;\\n\"])));var useStyles=makeStyles({createButton:{width:'50%',fontSize:'9px',margin:'1%',top:'10vh'},button:{width:'50%',fontSize:'9px',margin:'1%'}});export default function FeedCard(_ref){var selectedGroup=_ref.selectedGroup,updateGroups=_ref.updateGroups,leaveGroup=_ref.leaveGroup,deleteGroup=_ref.deleteGroup;var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),openPopup=_useState2[0],setOpenPopup=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openChoiceBox=_useState4[0],setOpenChoiceBox=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),nextActivity=_useState6[0],setNextActivity=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openActivityPopup=_useState8[0],setOpenActivityPopup=_useState8[1];var _useState9=useState({firstName:'',surname:'',userId:'',email:'',image:'',password:'',phoneNumber:'',activityLevel:'',points:''}),_useState10=_slicedToArray(_useState9,2),selectedUser=_useState10[0],setSelectedUser=_useState10[1];var _useContext=useContext(UserContext),user=_useContext.user;var getNextActivity=function getNextActivity(){var url=\"group/\".concat(selectedGroup.groupId,\"/activity\");axios.get(url,config).then(function(response){console.log(response.data['activities']);var nextAct=sortNextActivity(response.data['activities']);if(nextAct!==null){setNextActivity(nextAct);}else{setNextActivity(undefined);}}).then(function(){return updateGroups();}).catch(function(error){setNextActivity(undefined);console.log(error.response);});};var sortNextActivity=function sortNextActivity(activities){var now=new Date().getTime();var currActivity=activities[0];activities.forEach(function(activity){if(activity.time<currActivity.time&&activity.time-7200000>=now){console.log(activity.title+' '+new Date(activity.time).toLocaleString());currActivity=activity;}});if(currActivity.time<now){return null;}else{return currActivity;}};useEffect(function(){getNextActivity();},[selectedGroup,openPopup]);var handleUserClicked=function handleUserClicked(userClicked){if(Object.values(userClicked)[0].toString()!==user&&user===Object.values(selectedGroup.owner)[0].toString()){setSelectedUser(userClicked);setOpenChoiceBox(!openChoiceBox);}};var register=function register(activityId){return new Promise(function(resolve){axios.delete(\"/user/\".concat(user,\"/activity/\").concat(activityId),config);resolve();});};var unRegister=function unRegister(activityId){return new Promise(function(resolve){axios.post('/user/activity',{userId:user,activityId:activityId},config);resolve();});};var handleLeaveGroup=function handleLeaveGroup(){leaveGroup();updateGroups();};var deleteActivity=function deleteActivity(id){axios.delete(\"/activity/\".concat(id),config).then(getNextActivity).then(function(){return window.location.reload();});};var handleOnChangeOwner=function handleOnChangeOwner(){var url=\"/group/\".concat(selectedGroup.groupId);console.log(Object.values(selectedUser)[0]);axios.put(url,{groupId:selectedGroup.groupId,newOwner:Object.values(selectedUser)[0]},config).then(function(response){console.log(response);}).then(function(){updateGroups();setOpenChoiceBox(!openChoiceBox);}).catch(function(error){console.log(error.response.data);});};var isDisabled=function isDisabled(){if(selectedGroup.owner.userId==user)return false;else return true;};return selectedGroup.groupName!==''?/*#__PURE__*/_jsxs(StyledCard,{raised:true,children:[/*#__PURE__*/_jsx(StyledHeader,{children:selectedGroup.groupName}),/*#__PURE__*/_jsx(Divider,{variant:\"middle\"}),/*#__PURE__*/_jsxs(List,{style:{width:'40%',float:'right',maxHeight:'160px',overflow:'auto'},children:[selectedGroup.users.map(function(user,index){return/*#__PURE__*/_jsxs(ListItem,{button:true,onClick:function onClick(){return handleUserClicked(user);},children:[/*#__PURE__*/_jsx(UserAvatar,{user:user,type:\"small\",marginRight:\"0.5rem\"}),Object.values(user)[0]==Object.values(selectedGroup.owner)[0]?/*#__PURE__*/_jsx(ListItemText,{primary:user.firstName+' '+user.surname+'(eier)'}):/*#__PURE__*/_jsx(ListItemText,{primary:user.firstName+' '+user.surname})]},index);}),/*#__PURE__*/_jsxs(Dialog,{open:openChoiceBox,onClose:function onClose(){return setOpenChoiceBox(false);},children:[/*#__PURE__*/_jsx(DialogTitle,{children:'Vil du gjÃ¸re'+selectedUser.firstName+' '+selectedUser.surname+' til eier av gruppen?'}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return handleOnChangeOwner();},color:\"primary\",children:\"Ja\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setOpenChoiceBox(!openChoiceBox);},color:\"primary\",autoFocus:true,children:\"Nei\"})]})]})]}),/*#__PURE__*/_jsxs(ActivityDiv,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Neste aktvitet\"}),/*#__PURE__*/_jsx(TransformDiv,{children:nextActivity?/*#__PURE__*/_jsx(ActivityCard,{activity:nextActivity,openPopup:openActivityPopup,setOpenPopup:setOpenActivityPopup,setActivity:setNextActivity}):/*#__PURE__*/_jsx(StyledParagraph,{children:\"Finner ingen aktivitet aktiviteter for denne gruppen, legg til en ny aktivitet!\"})}),/*#__PURE__*/_jsxs(Button,{className:classes.createButton,onClick:function onClick(){return setOpenPopup(!openPopup);},variant:\"contained\",color:\"primary\",children:[' ',\"Opprett ny gruppeaktivitet\",' ',/*#__PURE__*/_jsx(AddIcon,{style:{marginLeft:'8px'}})]}),/*#__PURE__*/_jsx(Popup,{title:\"Legg til aktivitet\",openPopup:openPopup,setOpenPopup:setOpenPopup,maxWidth:\"md\",children:/*#__PURE__*/_jsx(ActivityForm,{openPopup:openPopup,setOpenPopup:setOpenPopup,groupId:selectedGroup.groupId})})]}),nextActivity&&/*#__PURE__*/_jsx(Popup,{openPopup:openActivityPopup,setOpenPopup:setOpenActivityPopup,maxWidth:\"md\",children:/*#__PURE__*/_jsx(ActivityInformation,{register:register,unRegister:unRegister,deleteActivity:deleteActivity,activity:nextActivity,setOpenPopup:setOpenActivityPopup,openPopup:openActivityPopup})}),/*#__PURE__*/_jsx(GroupLeaderboard,{users:selectedGroup.users}),/*#__PURE__*/_jsxs(StyledButtons,{children:[/*#__PURE__*/_jsxs(Button,{className:classes.button,onClick:handleLeaveGroup,variant:\"contained\",color:\"primary\",children:[' ',\"Forlat Gruppe \",/*#__PURE__*/_jsx(DeleteIcon,{style:{marginLeft:'8px'}})]}),/*#__PURE__*/_jsxs(Button,{className:classes.button,onClick:deleteGroup,variant:\"contained\",color:\"primary\",disabled:isDisabled(),children:[' ',\"Slett Gruppe \",/*#__PURE__*/_jsx(DeleteIcon,{style:{marginLeft:'8px'}})]})]})]}):/*#__PURE__*/_jsx(FeedContainer,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Ingen gruppe valgt\"})});}","map":{"version":3,"sources":["/Users/olelokken/DEV/gidd/client/src/components/GroupsAndFriendsComponents/FeedCard.tsx"],"names":["Button","Card","Dialog","DialogActions","DialogTitle","Divider","List","ListItem","ListItemText","makeStyles","Typography","withStyles","React","styled","DeleteIcon","AddIcon","Popup","ActivityForm","useState","ActivityCard","useEffect","axios","UserContext","useContext","ActivityInformation","UserAvatar","GroupLeaderboard","config","StyledHeader","h2","StyledParagraph","p","FeedContainer","div","StyledCard","root","marginBottom","marginLeft","marginTop","minHeigth","ActivityDiv","TransformDiv","StyledButtons","useStyles","createButton","width","fontSize","margin","top","button","FeedCard","selectedGroup","updateGroups","leaveGroup","deleteGroup","classes","openPopup","setOpenPopup","openChoiceBox","setOpenChoiceBox","nextActivity","setNextActivity","openActivityPopup","setOpenActivityPopup","firstName","surname","userId","email","image","password","phoneNumber","activityLevel","points","selectedUser","setSelectedUser","user","getNextActivity","url","groupId","get","then","response","console","log","data","nextAct","sortNextActivity","undefined","catch","error","activities","now","Date","getTime","currActivity","forEach","activity","time","title","toLocaleString","handleUserClicked","userClicked","Object","values","toString","owner","register","activityId","Promise","resolve","delete","unRegister","post","handleLeaveGroup","deleteActivity","id","window","location","reload","handleOnChangeOwner","put","newOwner","isDisabled","groupName","float","maxHeight","overflow","users","map","index"],"mappings":"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","sourcesContent":["import {\n    Button,\n    Card,\n    Dialog,\n    DialogActions,\n    DialogTitle,\n    Divider,\n    List,\n    ListItem,\n    ListItemText,\n    makeStyles,\n    Typography,\n    withStyles,\n} from '@material-ui/core';\nimport React from 'react';\nimport styled from 'styled-components';\nimport Group from '../../interfaces/Group';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport AddIcon from '@material-ui/icons/Add';\nimport Popup from '../Popup';\nimport ActivityForm from '../ActivityComponents/ActivityForm';\nimport { useState } from 'react';\nimport ActivityCard from '../ActivityComponents/ActivityCard';\nimport ActivityResponse from '../../interfaces/ActivityResponse';\nimport { useEffect } from 'react';\nimport axios from '../../Axios';\nimport User from '../../interfaces/User';\nimport { UserContext } from '../../UserContext';\nimport { useContext } from 'react';\nimport ActivityInformation from '../ActivityComponents/ActivityInformation';\nimport UserAvatar from '../UserAvatar';\nimport GroupLeaderboard from '../LeaderboardComponents/GroupLeaderboard';\nimport config from '../../Config';\n\nconst StyledHeader = styled.h2`\n    text-align: center;\n    font-size: 30px;\n`;\n\nconst StyledParagraph = styled.p`\n    font-size: 10px;\n`;\n\nconst FeedContainer = styled.div`\n    margin-left: 20px;\n    min-height: 60%;\n`;\n\nconst StyledCard = withStyles({\n    root: {\n        marginBottom: '1rem',\n        marginLeft: '1rem',\n        marginTop: '1rem',\n        minHeigth: '60%',\n    },\n})(Card);\n\nconst ActivityDiv = styled.div`\n    margin: 5%;\n    width: 50%;\n    height: 60vh;\n`;\n\nconst TransformDiv = styled.div`\n    transition: transform 450ms;\n    min-width: 200px;\n    max-width: 20%;\n    max-height: 20%;\n    margin-top: 5%;\n    margin-bottom: 11rem;\n\n    :hover {\n        transform: scale(1.08);\n        cursor: pointer;\n    }\n`;\n\n\n\nconst StyledButtons = styled.div`\n    display: flex;\n    padding: 1rem;\n    justify-content: center;\n`;\n\nconst useStyles = makeStyles({\n    createButton: {\n        width: '50%',\n        fontSize: '9px',\n        margin: '1%',\n        top: '10vh',\n    },\n    button: {\n        width: '50%',\n        fontSize: '9px',\n        margin: '1%',\n    },\n});\n\ninterface Props {\n    selectedGroup: Group;\n    updateGroups: () => void;\n    leaveGroup: () => void;\n    deleteGroup: () => void;\n}\n\nexport default function FeedCard({\n    selectedGroup,\n    updateGroups,\n    leaveGroup,\n    deleteGroup,\n}: Props) {\n    const classes = useStyles();\n    const [openPopup, setOpenPopup] = useState<boolean>(false);\n    const [openChoiceBox, setOpenChoiceBox] = useState<boolean>(false);\n    const [nextActivity, setNextActivity] = useState<\n        ActivityResponse | undefined\n    >();\n    const [openActivityPopup, setOpenActivityPopup] = useState<boolean>(false);\n    const [selectedUser, setSelectedUser] = useState<User>({\n        firstName: '',\n        surname: '',\n        userId: '',\n        email: '',\n        image: '',\n        password: '',\n        phoneNumber: '',\n        activityLevel: '',\n        points: '',\n    });\n    const { user } = useContext(UserContext);\n\n    const getNextActivity = () => {\n        const url = `group/${selectedGroup.groupId}/activity`;\n        axios\n            .get(url, config)\n            .then((response) => {\n                console.log(response.data['activities']);\n                const nextAct = sortNextActivity(response.data['activities']);\n                if (nextAct !== null) {\n                    setNextActivity(nextAct);\n                } else {\n                    setNextActivity(undefined);\n                }\n            })\n            .then(() => updateGroups())\n            .catch((error) => {\n                setNextActivity(undefined);\n                console.log(error.response);\n            });\n    };\n\n    const sortNextActivity = (activities: ActivityResponse[]) => {\n        const now = new Date().getTime();\n        let currActivity:ActivityResponse = activities[0];\n        activities.forEach((activity) => {\n            if (\n                activity.time < currActivity.time &&\n                activity.time - 7200000 >= now\n            ) {\n                console.log(\n                    activity.title +\n                        ' ' +\n                        new Date(activity.time).toLocaleString()\n                );\n                currActivity = activity;\n            }\n        });\n        if (currActivity.time < now) {\n            return null;\n        } else {\n            return currActivity;\n        }\n    };\n\n    useEffect(() => {\n        getNextActivity();\n    }, [selectedGroup, openPopup]);\n\n    const handleUserClicked = (userClicked: User) => {\n        if (\n            Object.values(userClicked)[0].toString() !== user &&\n            user === Object.values(selectedGroup.owner)[0].toString()\n        ) {\n            setSelectedUser(userClicked);\n            setOpenChoiceBox(!openChoiceBox);\n        }\n    };\n\n    const register = (activityId: number): Promise<void> => {\n        return new Promise((resolve) => {\n            axios.delete(`/user/${user}/activity/${activityId}`, config);\n            resolve();\n        });\n    };\n\n    const unRegister = (activityId: number): Promise<void> => {\n        return new Promise((resolve) => {\n            axios.post(\n                '/user/activity',\n                {\n                    userId: user,\n                    activityId: activityId,\n                },\n                config\n            );\n            resolve();\n        });\n    };\n\n    const handleLeaveGroup = () => {\n        leaveGroup();\n        updateGroups();\n    };\n\n    const deleteActivity = (id: number) => {\n        axios\n            .delete(`/activity/${id}`, config)\n            .then(getNextActivity)\n            .then(() => window.location.reload());\n    };\n\n    const handleOnChangeOwner = () => {\n        const url = `/group/${selectedGroup.groupId}`;\n        console.log(Object.values(selectedUser)[0]);\n        axios\n            .put(\n                url,\n                {\n                    groupId: selectedGroup.groupId,\n                    newOwner: Object.values(selectedUser)[0],\n                },\n                config\n            )\n            .then((response) => {\n                console.log(response);\n            })\n            .then(() => {\n                updateGroups();\n                setOpenChoiceBox(!openChoiceBox);\n            })\n            .catch((error) => {\n                console.log(error.response.data);\n            });\n    };\n\n    const isDisabled = (): boolean => {\n        if (selectedGroup.owner.userId == user) return false;\n        else return true;\n    };\n\n    return selectedGroup.groupName !== '' ? (\n        <StyledCard raised={true}>\n            <StyledHeader>{selectedGroup.groupName}</StyledHeader>\n            <Divider variant=\"middle\" />\n            <List\n                style={{\n                    width: '40%',\n                    float: 'right',\n                    maxHeight: '160px',\n                    overflow: 'auto',\n                }}\n            >\n                {selectedGroup.users.map((user, index) => (\n                    <ListItem\n                        button\n                        key={index}\n                        onClick={() => handleUserClicked(user)}\n                    >\n                        <UserAvatar\n                            user={user}\n                            type=\"small\"\n                            marginRight=\"0.5rem\"\n                        ></UserAvatar>\n                        {Object.values(user)[0] ==\n                        Object.values(selectedGroup.owner)[0] ? (\n                            <ListItemText\n                                primary={\n                                    user.firstName +\n                                    ' ' +\n                                    user.surname +\n                                    '(eier)'\n                                }\n                            />\n                        ) : (\n                            <ListItemText\n                                primary={user.firstName + ' ' + user.surname}\n                            />\n                        )}\n                    </ListItem>\n                ))}\n                <Dialog\n                    open={openChoiceBox}\n                    onClose={() => setOpenChoiceBox(false)}\n                >\n                    <DialogTitle>\n                        {'Vil du gjÃ¸re' +\n                            selectedUser.firstName +\n                            ' ' +\n                            selectedUser.surname +\n                            ' til eier av gruppen?'}\n                    </DialogTitle>\n                    <DialogActions>\n                        <Button\n                            onClick={() => handleOnChangeOwner()}\n                            color=\"primary\"\n                        >\n                            Ja\n                        </Button>\n                        <Button\n                            onClick={() => setOpenChoiceBox(!openChoiceBox)}\n                            color=\"primary\"\n                            autoFocus\n                        >\n                            Nei\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </List>\n            <ActivityDiv>\n                <Typography variant=\"h6\">Neste aktvitet</Typography>\n                <TransformDiv>\n                    {nextActivity ? (\n                        <ActivityCard\n                            activity={nextActivity}\n                            openPopup={openActivityPopup}\n                            setOpenPopup={setOpenActivityPopup}\n                            setActivity={setNextActivity}\n                        ></ActivityCard>\n                    ) : (\n                        <StyledParagraph>\n                            Finner ingen aktivitet aktiviteter for denne\n                            gruppen, legg til en ny aktivitet!\n                        </StyledParagraph>\n                    )}\n                </TransformDiv>\n                <Button\n                    className={classes.createButton}\n                    onClick={() => setOpenPopup(!openPopup)}\n                    variant=\"contained\"\n                    color=\"primary\"\n                >\n                    {' '}\n                    Opprett ny gruppeaktivitet{' '}\n                    <AddIcon style={{ marginLeft: '8px' }} />\n                </Button>\n                <Popup\n                    title=\"Legg til aktivitet\"\n                    openPopup={openPopup}\n                    setOpenPopup={setOpenPopup}\n                    maxWidth=\"md\"\n                >\n                    <ActivityForm\n                        openPopup={openPopup}\n                        setOpenPopup={setOpenPopup}\n                        groupId={selectedGroup.groupId}\n                    />\n                </Popup>\n            </ActivityDiv>\n            {nextActivity && (\n                <Popup\n                    openPopup={openActivityPopup}\n                    setOpenPopup={setOpenActivityPopup}\n                    maxWidth=\"md\"\n                >\n                    <ActivityInformation\n                        register={register}\n                        unRegister={unRegister}\n                        deleteActivity={deleteActivity}\n                        activity={nextActivity}\n                        setOpenPopup={setOpenActivityPopup}\n                        openPopup={openActivityPopup}\n                    />\n                </Popup>\n            )}\n            <GroupLeaderboard users={selectedGroup.users} />\n            <StyledButtons>\n                <Button\n                    className={classes.button}\n                    onClick={handleLeaveGroup}\n                    variant=\"contained\"\n                    color=\"primary\"\n                >\n                    {' '}\n                    Forlat Gruppe <DeleteIcon style={{ marginLeft: '8px' }} />\n                </Button>\n                <Button\n                    className={classes.button}\n                    onClick={deleteGroup}\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disabled={isDisabled()}\n                >\n                    {' '}\n                    Slett Gruppe <DeleteIcon style={{ marginLeft: '8px' }} />\n                </Button>\n            </StyledButtons>\n        </StyledCard>\n    ) : (\n        <FeedContainer>\n            <h2>Ingen gruppe valgt</h2>\n        </FeedContainer>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}