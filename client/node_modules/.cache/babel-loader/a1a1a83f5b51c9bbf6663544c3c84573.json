{"ast":null,"code":"var _jsxFileName = \"/Users/olelokken/DEV/gidd/client/src/containers/Calendar.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport axios from '../Axios';\nimport styled from 'styled-components';\nimport { UserContext } from '../UserContext';\nimport Popup from '../components/Popup';\nimport ActivityInformation from '../components/ActivityComponents/ActivityInformation';\nimport config from '../Config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CalendarContainer = styled.div`\n    --fc-button-bg-color: #f44336;\n    --fc-button-active-bg-color: #f44336;\n    --fc-button-hover-bg-color: #f66055;\n    --fc-today-bg-color: #fde9e7;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto',\n        'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',\n        'Helvetica Neue', sans-serif;\n    --fc-event-font-size: 50px;\n`;\n_c = CalendarContainer;\nconst todayStr = new Date().toISOString().replace(/T.*$/, '') + 'T' + new Date().toLocaleTimeString();\n\nconst Calender = () => {\n  _s();\n\n  const {\n    user\n  } = useContext(UserContext);\n  const [activities, setActivities] = useState([]);\n  const [openPopup, setOpenPopup] = useState(false);\n  const [activity, setActivity] = useState({\n    activityId: 0,\n    activityLevel: 'MEDIUM',\n    capacity: 0,\n    daysToRepeat: 0,\n    description: 'test',\n    equipments: [],\n    groupId: 0,\n    image: '',\n    latitude: 0,\n    longitude: 0,\n    registeredParticipants: [],\n    tags: ['SII'],\n    time: 1618924200000,\n    timeCreated: 1618830691000,\n    title: 'Test',\n    user: 1231323\n  });\n  useEffect(() => {\n    loadActivities();\n  }, []);\n\n  const deleteActivity = id => {\n    axios.delete(`/activity/${id}`, config).then(() => loadActivities());\n  };\n\n  const handleOnClick = eventInfo => {\n    console.log('token:' + localStorage.getItem('token'));\n    console.log('refreshToken:' + localStorage.getItem('refreshToken'));\n    console.log('bruker: ' + user);\n    console.log(activities);\n    const activityID = eventInfo.event.extendedProps.ID;\n    const url = `/activity/${activityID}`;\n    axios.get(url).then(response => {\n      setActivity(response.data);\n      setOpenPopup(!openPopup);\n    }).catch(error => {\n      console.log('Kunne ikke hente aktivitet: ' + error.message);\n    });\n  };\n\n  const handleEventEnter = eventInfo => {\n    eventInfo.event.setProp('backgroundColor', '#f66055');\n  };\n\n  const handleEventLeave = eventInfo => {\n    const normalColor = eventInfo.event.extendedProps.formattedDate > todayStr ? '#f44336' : '#f66055';\n    eventInfo.event.setProp('backgroundColor', normalColor);\n  };\n\n  const register = activityId => {\n    console.log(activityId + ' ' + user);\n    return new Promise(resolve => {\n      axios.post('/user/activity', {\n        userId: user,\n        activityId: activityId\n      }, config);\n      resolve();\n    });\n  };\n\n  const unRegister = activityId => {\n    return new Promise(resolve => {\n      axios.delete(`/user/${user}/activity/${activityId}`, config).then(() => loadActivities()).catch(error => {\n        console.log(error.response.data);\n      });\n      resolve();\n    });\n  };\n\n  const loadActivities = () => {\n    const id = localStorage.getItem('userID');\n    const url = `/user/${id}/activity`;\n    setActivities([]);\n    axios.get(url, config).then(response => {\n      console.log(response.data['activities']);\n      response.data['activities'].forEach(activity => {\n        const date = new Date(activity.time);\n        const curr_date = date.getDate();\n        const curr_month = date.getMonth() + 1 >= 10 ? date.getMonth() : '0' + (date.getMonth() + 1);\n        const curr_year = date.getFullYear();\n        const curr_hour = date.getHours() - 2 < 10 ? '0' + (date.getHours() - 2) : date.getHours() - 2;\n        const curr_minutes = date.getMinutes() == 0 ? date.getMinutes() + '0' : date.getMinutes();\n        const curr_seconds = date.getSeconds() == 0 ? date.getSeconds() + '0' : date.getSeconds();\n        const formattedDate = curr_year + '-' + curr_month + '-' + curr_date + 'T' + curr_hour + ':' + curr_minutes + ':' + curr_seconds;\n        const formattedEnd = curr_year + '-' + curr_month + '-' + curr_date + 'T' + curr_hour + ':' + curr_minutes + ':' + curr_seconds;\n        setActivities(activities => [...activities, {\n          ID: activity.activityId,\n          title: activity.title,\n          start: formattedDate,\n          end: formattedEnd,\n          formattedDate: formattedDate,\n          backgroundColor: formattedDate > todayStr ? '#f44336' : '#f66055'\n        }]);\n      });\n    }).catch(error => {\n      console.log(error.response.data);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(CalendarContainer, {\n    children: [/*#__PURE__*/_jsxDEV(FullCalendar, {\n      plugins: [dayGridPlugin, timeGridPlugin, interactionPlugin],\n      headerToolbar: {\n        left: 'prev,next today',\n        center: 'title',\n        right: 'dayGridMonth,timeGridWeek,timeGridDay'\n      },\n      height: \"750px\",\n      initialView: \"timeGridWeek\",\n      editable: true,\n      selectable: false,\n      selectMirror: true,\n      dayMaxEvents: true,\n      allDaySlot: false,\n      locale: 'en-GB',\n      displayEventEnd: true,\n      buttonText: {\n        today: 'I dag',\n        month: 'Måned',\n        week: 'Uke',\n        day: 'Dag'\n      },\n      slotEventOverlap: false,\n      eventDisplay: 'block',\n      progressiveEventRendering: true,\n      events: activities,\n      firstDay: 1,\n      eventMouseEnter: handleEventEnter,\n      eventMouseLeave: handleEventLeave,\n      dayHeaderFormat: {\n        weekday: 'short',\n        month: 'numeric',\n        day: 'numeric',\n        omitCommas: true,\n        hour12: false\n      },\n      slotLabelFormat: {\n        hour12: false,\n        hour: 'numeric',\n        minute: '2-digit',\n        omitZeroMinute: false,\n        meridiem: 'short'\n      },\n      eventClick: handleOnClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Popup, {\n      title: \"Legg til aktivitet\",\n      openPopup: openPopup,\n      setOpenPopup: setOpenPopup,\n      maxWidth: \"md\",\n      children: /*#__PURE__*/_jsxDEV(ActivityInformation, {\n        register: register,\n        unRegister: unRegister,\n        activity: activity,\n        deleteActivity: deleteActivity,\n        setOpenPopup: setOpenPopup,\n        openPopup: openPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 194,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Calender, \"otmtDWMRORQlZaTY1ux55//gQUI=\");\n\n_c2 = Calender;\nexport default Calender;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CalendarContainer\");\n$RefreshReg$(_c2, \"Calender\");","map":{"version":3,"sources":["/Users/olelokken/DEV/gidd/client/src/containers/Calendar.tsx"],"names":["React","useContext","useEffect","useState","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","axios","styled","UserContext","Popup","ActivityInformation","config","CalendarContainer","div","todayStr","Date","toISOString","replace","toLocaleTimeString","Calender","user","activities","setActivities","openPopup","setOpenPopup","activity","setActivity","activityId","activityLevel","capacity","daysToRepeat","description","equipments","groupId","image","latitude","longitude","registeredParticipants","tags","time","timeCreated","title","loadActivities","deleteActivity","id","delete","then","handleOnClick","eventInfo","console","log","localStorage","getItem","activityID","event","extendedProps","ID","url","get","response","data","catch","error","message","handleEventEnter","setProp","handleEventLeave","normalColor","formattedDate","register","Promise","resolve","post","userId","unRegister","forEach","date","curr_date","getDate","curr_month","getMonth","curr_year","getFullYear","curr_hour","getHours","curr_minutes","getMinutes","curr_seconds","getSeconds","formattedEnd","start","end","backgroundColor","left","center","right","today","month","week","day","weekday","omitCommas","hour12","hour","minute","omitZeroMinute","meridiem"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport { EventInput } from '@fullcalendar/react';\nimport axios from '../Axios';\nimport styled from 'styled-components';\nimport { UserContext } from '../UserContext';\nimport Popup from '../components/Popup';\nimport ActivityInformation from '../components/ActivityComponents/ActivityInformation';\nimport ActivityResponse from '../interfaces/ActivityResponse';\nimport config from '../Config';\n\nconst CalendarContainer = styled.div`\n    --fc-button-bg-color: #f44336;\n    --fc-button-active-bg-color: #f44336;\n    --fc-button-hover-bg-color: #f66055;\n    --fc-today-bg-color: #fde9e7;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto',\n        'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',\n        'Helvetica Neue', sans-serif;\n    --fc-event-font-size: 50px;\n`;\n\nconst todayStr =\n    new Date().toISOString().replace(/T.*$/, '') +\n    'T' +\n    new Date().toLocaleTimeString();\n\nconst Calender = () => {\n    const { user } = useContext(UserContext);\n    const [activities, setActivities] = useState<EventInput[]>([]);\n    const [openPopup, setOpenPopup] = useState<boolean>(false);\n    const [activity, setActivity] = useState<ActivityResponse>({\n        activityId: 0,\n        activityLevel: 'MEDIUM',\n        capacity: 0,\n        daysToRepeat: 0,\n        description: 'test',\n        equipments: [],\n        groupId: 0,\n        image: '',\n        latitude: 0,\n        longitude: 0,\n        registeredParticipants: [],\n        tags: ['SII'],\n        time: 1618924200000,\n        timeCreated: 1618830691000,\n        title: 'Test',\n        user: 1231323\n    }\n    );\n\n\n    useEffect(() => {\n        loadActivities();\n    }, []);\n\n    const deleteActivity = (id: number) => {\n        axios\n            .delete(`/activity/${id}`, config)\n            .then(() => loadActivities());\n    };\n\n    const handleOnClick = (eventInfo: EventInput) => {\n        console.log('token:' + localStorage.getItem('token'));\n        console.log('refreshToken:' + localStorage.getItem('refreshToken'));\n        console.log('bruker: ' + user);\n        console.log(activities);\n        const activityID = eventInfo.event.extendedProps.ID;\n        const url = `/activity/${activityID}`;\n        axios\n            .get(url)\n            .then((response) => {\n                setActivity(response.data);\n                setOpenPopup(!openPopup);\n            })\n            .catch((error) => {\n                console.log('Kunne ikke hente aktivitet: ' + error.message);\n            });\n    };\n\n    const handleEventEnter = (eventInfo: any) => {\n        eventInfo.event.setProp('backgroundColor', '#f66055');\n    };\n\n    const handleEventLeave = (eventInfo: any) => {\n        const normalColor =\n            eventInfo.event.extendedProps.formattedDate > todayStr\n                ? '#f44336'\n                : '#f66055';\n        eventInfo.event.setProp('backgroundColor', normalColor);\n    };\n\n\n    const register = (activityId: number): Promise<void> => {\n        console.log(activityId + ' ' + user);\n        return new Promise((resolve) => {\n            axios\n                .post('/user/activity', {\n                    userId: user,\n                    activityId: activityId,\n                }, config);\n            resolve();\n        });\n    };\n\n    const unRegister = (activityId: number): Promise<void> => {\n        return new Promise((resolve) => {\n            axios\n                .delete(`/user/${user}/activity/${activityId}`, config)\n                .then(() => loadActivities()).catch(error => {\n                    console.log(error.response.data)\n                });\n            resolve();\n        });\n    };\n\n    const loadActivities = () => {\n        const id = localStorage.getItem('userID');\n        const url = `/user/${id}/activity`;\n        setActivities([])\n        axios\n            .get(url, config)\n            .then((response) => {\n                console.log(response.data['activities']);\n                response.data['activities'].forEach((activity: any) => {\n                    const date = new Date(activity.time);\n                    const curr_date = date.getDate();\n                    const curr_month =\n                        date.getMonth() + 1 >= 10\n                            ? date.getMonth()\n                            : '0' + (date.getMonth() + 1);\n                    const curr_year = date.getFullYear();\n                    const curr_hour =\n                        date.getHours() - 2 < 10\n                            ? '0' + (date.getHours() - 2)\n                            : date.getHours() - 2;\n                    const curr_minutes =\n                        date.getMinutes() == 0\n                            ? date.getMinutes() + '0'\n                            : date.getMinutes();\n                    const curr_seconds =\n                        date.getSeconds() == 0\n                            ? date.getSeconds() + '0'\n                            : date.getSeconds();\n                    const formattedDate =\n                        curr_year +\n                        '-' +\n                        curr_month +\n                        '-' +\n                        curr_date +\n                        'T' +\n                        curr_hour +\n                        ':' +\n                        curr_minutes +\n                        ':' +\n                        curr_seconds;\n                    const formattedEnd =\n                        curr_year +\n                        '-' +\n                        curr_month +\n                        '-' +\n                        curr_date +\n                        'T' +\n                        curr_hour +\n                        ':' +\n                        curr_minutes +\n                        ':' +\n                        curr_seconds;\n                    setActivities((activities) => [\n                        ...activities,\n                        {\n                            ID: activity.activityId,\n                            title: activity.title,\n                            start: formattedDate,\n                            end: formattedEnd,\n                            formattedDate: formattedDate,\n                            backgroundColor:\n                                formattedDate > todayStr\n                                    ? '#f44336'\n                                    : '#f66055',\n                        },\n                    ]);\n                });\n            })\n            .catch((error: any) => {\n                console.log(error.response.data)\n            });\n    };\n\n    return (\n        <CalendarContainer>\n            <FullCalendar\n                plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n                headerToolbar={{\n                    left: 'prev,next today',\n                    center: 'title',\n                    right: 'dayGridMonth,timeGridWeek,timeGridDay',\n                }}\n                height=\"750px\"\n                initialView=\"timeGridWeek\"\n                editable={true}\n                selectable={false}\n                selectMirror={true}\n                dayMaxEvents={true}\n                allDaySlot={false}\n                locale={'en-GB'}\n                displayEventEnd={true}\n                buttonText={{\n                    today: 'I dag',\n                    month: 'Måned',\n                    week: 'Uke',\n                    day: 'Dag',\n                }}\n                slotEventOverlap={false}\n                eventDisplay={'block'}\n                progressiveEventRendering={true}\n                events={activities}\n                firstDay={1}\n                eventMouseEnter={handleEventEnter}\n                eventMouseLeave={handleEventLeave}\n                dayHeaderFormat={{\n                    weekday: 'short',\n                    month: 'numeric',\n                    day: 'numeric',\n                    omitCommas: true,\n                    hour12: false,\n                }}\n                slotLabelFormat={{\n                    hour12: false,\n                    hour: 'numeric',\n                    minute: '2-digit',\n                    omitZeroMinute: false,\n                    meridiem: 'short',\n                }}\n                eventClick={handleOnClick}\n            />\n            <Popup\n                title=\"Legg til aktivitet\"\n                openPopup={openPopup}\n                setOpenPopup={setOpenPopup}\n                maxWidth=\"md\"\n            >\n                <ActivityInformation\n                    register={register}\n                    unRegister={unRegister}\n                    activity={activity}\n                    deleteActivity={deleteActivity}\n                    setOpenPopup={setOpenPopup}\n                    openPopup={openPopup}\n                />\n            </Popup>\n        </CalendarContainer>\n    );\n};\n\nexport default Calender;\n"]},"metadata":{},"sourceType":"module"}