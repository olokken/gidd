{"ast":null,"code":"import _objectSpread from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useState,useEffect}from\"react\";import{Redirect,Route}from'react-router';import axios from'./Axios';import{jsx as _jsx}from\"react/jsx-runtime\";var PrivateRoute=function PrivateRoute(_ref){var Component=_ref.component,rest=_objectWithoutProperties(_ref,[\"component\"]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),authenticated=_useState2[0],setAuthenticated=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingComplete=_useState4[0],setLoadingComplete=_useState4[1];useEffect(function(){var isLogin=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var id,token,config;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:id=localStorage.getItem('userID');token=localStorage.getItem('token');config={headers:{token:token}};_context.next=5;return axios.post(\"security/token/validate\",{userId:id},config).then(function(response){if(response.data.result==='true'){setAuthenticated(true);}else{setAuthenticated(false);}}).catch(function(error){console.log('Feil ved request av validering '+error.message);});case 5:setLoadingComplete(true);case 6:case\"end\":return _context.stop();}}},_callee);}));return function isLogin(){return _ref2.apply(this,arguments);};}();isLogin();},[]);if(loadingComplete){return/*#__PURE__*/_jsx(Route,_objectSpread(_objectSpread({},rest),{},{render:function render(props){return authenticated?/*#__PURE__*/_jsx(Component,_objectSpread({},props)):/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}}));}else{return/*#__PURE__*/_jsx(\"div\",{children:\"Loading\"});}};export default PrivateRoute;","map":{"version":3,"sources":["/Users/olelokken/DEV/gidd/client/src/PrivateRoute.tsx"],"names":["React","useState","useEffect","Redirect","Route","axios","PrivateRoute","Component","component","rest","authenticated","setAuthenticated","loadingComplete","setLoadingComplete","isLogin","id","localStorage","getItem","token","config","headers","post","userId","then","response","data","result","catch","error","console","log","message","props"],"mappings":"mwBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,QAAT,CAAmBC,KAAnB,KAA4C,cAA5C,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,C,2CAQA,GAAMC,CAAAA,YAAwC,CAAG,QAA3CA,CAAAA,YAA2C,MAAuC,IAAzBC,CAAAA,SAAyB,MAApCC,SAAoC,CAAXC,IAAW,4DAC1CR,QAAQ,CAAC,KAAD,CADkC,wCAC7ES,aAD6E,eAC9DC,gBAD8D,8BAEtCV,QAAQ,CAAC,KAAD,CAF8B,yCAE7EW,eAF6E,eAE5DC,kBAF4D,eAIpFX,SAAS,CACL,UAAM,CACF,GAAMY,CAAAA,OAAO,2FAAG,uJACNC,EADM,CACDC,YAAY,CAACC,OAAb,CAAqB,QAArB,CADC,CAENC,KAFM,CAEEF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAFF,CAGNE,MAHM,CAGG,CACXC,OAAO,CAAE,CACLF,KAAK,CAAEA,KADF,CADE,CAHH,uBAQNb,CAAAA,KAAK,CAACgB,IAAN,2BACF,CACIC,MAAM,CAAEP,EADZ,CADE,CAGCI,MAHD,EAIJI,IAJI,CAIC,SAAAC,QAAQ,CAAI,CACf,GAAIA,QAAQ,CAACC,IAAT,CAAcC,MAAd,GAAyB,MAA7B,CAAqC,CACjCf,gBAAgB,CAAC,IAAD,CAAhB,CACH,CAFD,IAEO,CACHA,gBAAgB,CAAC,KAAD,CAAhB,CACH,CACJ,CAVK,EAUHgB,KAVG,CAUG,SAAAC,KAAK,CAAI,CACdC,OAAO,CAACC,GAAR,CAAY,kCAAoCF,KAAK,CAACG,OAAtD,EACH,CAZK,CARM,QAqBZlB,kBAAkB,CAAC,IAAD,CAAlB,CArBY,sDAAH,kBAAPC,CAAAA,OAAO,2CAAb,CAuBAA,OAAO,GACV,CA1BI,CA2BL,EA3BK,CAAT,CA8BA,GAAIF,eAAJ,CAAqB,CACjB,mBACI,KAAC,KAAD,gCAAWH,IAAX,MAAiB,MAAM,CAAE,gBAAAuB,KAAK,QAC1BtB,CAAAA,aAAa,cACT,KAAC,SAAD,kBAAesB,KAAf,EADS,cAEP,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAHoB,EAA9B,GADJ,CAOH,CARD,IAQO,CACH,mBAAQ,gCAAR,CACH,CACJ,CA7CD,CA+CA,cAAe1B,CAAAA,YAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Redirect, Route, RouteProps } from 'react-router';\nimport axios from './Axios'\n\n\n\ninterface PublicRouteProps extends RouteProps {\n    component: any;\n}\n\nconst PrivateRoute: React.FC<PublicRouteProps> = ({ component: Component, ...rest }) => {\n    const [authenticated, setAuthenticated] = useState(false);\n    const [loadingComplete, setLoadingComplete] = useState(false);\n\n    useEffect(\n        () => {\n            const isLogin = async () => {\n                const id = localStorage.getItem('userID');\n                const token = localStorage.getItem('token');\n                const config = {\n                    headers: {\n                        token: token,\n                    }\n                }\n                await axios.post(`security/token/validate`,\n                    {\n                        userId: id\n                    }, config\n                ).then(response => {\n                    if (response.data.result === 'true') {\n                        setAuthenticated(true);\n                    } else {\n                        setAuthenticated(false);\n                    }\n                }).catch(error => {\n                    console.log('Feil ved request av validering ' + error.message)\n                })\n                setLoadingComplete(true);\n            }\n            isLogin();\n        },\n        []\n    );\n\n    if (loadingComplete) {\n        return (\n            <Route {...rest} render={props => (\n                authenticated ?\n                    <Component {...props} />\n                    : <Redirect to=\"/\" />\n            )} />\n        );\n    } else {\n        return (<div>Loading</div>)\n    }\n}\n\nexport default PrivateRoute;\n\n"]},"metadata":{},"sourceType":"module"}