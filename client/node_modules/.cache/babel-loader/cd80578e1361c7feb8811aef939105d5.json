{"ast":null,"code":"import _toConsumableArray from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/olelokken/DEV/gidd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{useContext,useEffect,useState}from'react';import ActivityForm from'../components/ActivityComponents/ActivityForm';import styled from'styled-components';import SideFilter from'../components/FilterComponents/SideFilter';import SortMenu from'../components/SortingComponents/SortMenu';import ActivityGrid from'../components/ActivityComponents/ActivityGrid';import Popup from'../components/Popup';import AddButton from'../components/ActivityComponents/AddButton';import{Drawer,Button}from'@material-ui/core';import IconButton from'@material-ui/core/IconButton';import Divider from'@material-ui/core/Divider';import CloseIcon from'@material-ui/icons/Close';import{FilterFunctions}from'../components/FilterComponents/FilterFunctions';import axios from'../Axios';import{UserContext}from'../UserContext';import{SortFunctions}from'../components/SortingComponents/SortingFunctions';import config from'../Config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    display: flex;\\n    margin-left: 10px;\\n    width: 100%;\\n\"])));var AddAndSort=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    display: flex;\\n    justify-content: space-between;\\n\\n    @media only screen and (max-width: 951px) {\\n        flex-direction: column-reverse;\\n    }\\n\"])));var View=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    display: flex;\\n    flex-direction: column;\\n    width: 75%;\\n    margin-left: 3rem;\\n    margin-top: 10px;\\n    margin-right: 3rem;\\n\"])));var Activities=function Activities(){var _useContext=useContext(UserContext),user=_useContext.user;var _useState=useState({mobileView:false,drawerOpen:false}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),activities=_useState4[0],setActivities=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),currentActivities=_useState6[0],setCurrentActivities=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openPopup=_useState8[0],setOpenPopup=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),titleSearch=_useState10[0],setTitleSearch=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showMine=_useState12[0],setShowMine=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),showFuture=_useState14[0],setShowFuture=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),distance=_useState16[0],setDistance=_useState16[1];var _useState17=useState(new Date()),_useState18=_slicedToArray(_useState17,2),fromTime=_useState18[0],setFromTime=_useState18[1];var _useState19=useState(new Date()),_useState20=_slicedToArray(_useState19,2),toTime=_useState20[0],setToTime=_useState20[1];var _useState21=useState([0,20]),_useState22=_slicedToArray(_useState21,2),capacity=_useState22[0],setCapacity=_useState22[1];var _useState23=useState(),_useState24=_slicedToArray(_useState23,2),tags=_useState24[0],setTags=_useState24[1];var _useState25=useState({Low:true,Medium:true,High:true}),_useState26=_slicedToArray(_useState25,2),activityLevel=_useState26[0],setActivityLevel=_useState26[1];var _useState27=useState(),_useState28=_slicedToArray(_useState27,2),location=_useState28[0],setLocation=_useState28[1];var _useState29=useState(-1),_useState30=_slicedToArray(_useState29,2),sortValue=_useState30[0],setSortValue=_useState30[1];var register=function register(activityId){console.log(activityId+' '+user);return new Promise(function(resolve){axios.post('/user/activity',{userId:user,activityId:activityId},config).then(function(){return loadActivities();});resolve();});};var unRegister=function unRegister(activityId){return new Promise(function(resolve){axios.delete(\"/user/\".concat(user,\"/activity/\").concat(activityId),config).then(function(){return loadActivities();});resolve();});};useEffect(function(){if(activities){setCurrentActivities(activities);var filteredActivities=FilterFunctions.titleFilter(activities,titleSearch);filteredActivities=FilterFunctions.showMyActivities(filteredActivities,showMine,user);filteredActivities=FilterFunctions.showFutureActivities(filteredActivities,showFuture);filteredActivities=FilterFunctions.changeCapacity(filteredActivities,capacity);filteredActivities=FilterFunctions.dateToFilter(filteredActivities,new Date(toTime));filteredActivities=FilterFunctions.dateFromFilter(filteredActivities,new Date(fromTime));filteredActivities=FilterFunctions.activityLevelFilter(filteredActivities,activityLevel);filteredActivities=FilterFunctions.tagFilter(filteredActivities,tags);filteredActivities=FilterFunctions.distanceFilter(filteredActivities,distance,location);setCurrentActivities(filteredActivities);}},[titleSearch,activities,showFuture,showMine,capacity,fromTime,toTime,activityLevel,tags,distance]);var mobileView=state.mobileView,drawerOpen=state.drawerOpen;useEffect(function(){var setResponsiveness=function setResponsiveness(){return window.innerWidth<951?setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{mobileView:true});}):setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{mobileView:false});});};setResponsiveness();window.addEventListener('resize',function(){return setResponsiveness();});setCoordinates();},[]);var onClickAddButton=function onClickAddButton(){setOpenPopup(!openPopup);};var _deleteActivity=function deleteActivity(id){axios.delete(\"/activity/\".concat(id),config).then(loadActivities);};var setCoordinates=function setCoordinates(){fetch(\"https://geolocation-db.com/json/\".concat(process.env.REACT_APP_GEOLOCATION_KEY)).then(function(response){return response.json();}).then(function(data){if(data){var latitude=data.latitude;var longitude=data.longitude;console.log(latitude+', '+longitude);setLocation({lat:latitude,lng:longitude});}});};var reverse=function reverse(){setCurrentActivities(_toConsumableArray(currentActivities).reverse());};var loadActivities=function loadActivities(){axios.get(\"/activity?userId=\".concat(localStorage.getItem('userID'))).then(function(response){response.data;setActivities(response.data['activities']);}).catch(function(error){return console.log(error);});};useEffect(function(){if(sortValue==1){console.log('velger sort 1');var sortert=SortFunctions.comingSort(currentActivities);setCurrentActivities(sortert);}else if(sortValue==2){console.log('velger sort 2');var _sortert=SortFunctions.distanceSort(currentActivities,location);setCurrentActivities(_sortert);}else if(sortValue==3){console.log('velger sort 3');var _sortert2=SortFunctions.capacitySort(currentActivities);setCurrentActivities(_sortert2);}else if(sortValue==4){console.log('velger sort 4');var _sortert3=SortFunctions.activityLevelSort(currentActivities);setCurrentActivities(_sortert3);}},[sortValue]);useEffect(loadActivities,[openPopup]);var displayDesktop=function displayDesktop(){return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'20%'},children:/*#__PURE__*/_jsx(SideFilter,{onDistanceChange:function onDistanceChange(dist){return setDistance(dist);},onTimeFromChange:function onTimeFromChange(time){return setFromTime(time);},onTimeToChange:function onTimeToChange(time){setToTime(time);},onTitleSearch:function onTitleSearch(title){return setTitleSearch(title);},onLevelChange:function onLevelChange(level){return setActivityLevel(level);},onShowFuture:function onShowFuture(showFuture){return setShowFuture(showFuture);},onShowMine:function onShowMine(showMine){return setShowMine(showMine);},onCapacityChange:function onCapacityChange(range){return setCapacity(range);},onTagsChange:function onTagsChange(tags){return setTags(tags);}})}),/*#__PURE__*/_jsxs(View,{children:[/*#__PURE__*/_jsxs(AddAndSort,{children:[/*#__PURE__*/_jsx(SortMenu,{onSortChange:function onSortChange(val){setSortValue(val);},children:/*#__PURE__*/_jsx(Button,{onClick:reverse,children:\"Reverser n\\xE5v\\xE6rende liste\"})}),/*#__PURE__*/_jsx(AddButton,{onClick:onClickAddButton}),/*#__PURE__*/_jsx(Popup,{title:\"Legg til aktivitet\",openPopup:openPopup,setOpenPopup:setOpenPopup,maxWidth:\"lg\",children:/*#__PURE__*/_jsx(ActivityForm,{openPopup:openPopup,setOpenPopup:setOpenPopup})})]}),/*#__PURE__*/_jsx(ActivityGrid,{register:register,unRegister:unRegister,deleteActivity:function deleteActivity(id){return _deleteActivity(id);},activities:currentActivities})]})]});};var displayMobile=function displayMobile(){var handleDrawerOpen=function handleDrawerOpen(){return setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{drawerOpen:true});});};var handleDrawerClose=function handleDrawerClose(){return setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{drawerOpen:false});});};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(View,{children:[/*#__PURE__*/_jsxs(AddAndSort,{children:[/*#__PURE__*/_jsx(SortMenu,{onSortChange:function onSortChange(val){return setSortValue(val);},children:/*#__PURE__*/_jsx(Button,{onClick:reverse,children:\"Reverser n\\xE5v\\xE6rende liste\"})}),/*#__PURE__*/_jsx(Button,{style:{border:'1px solid lightgrey',marginTop:'5px'},onClick:handleDrawerOpen,children:\"Filtrer s\\xF8k\"}),/*#__PURE__*/_jsxs(Drawer,{style:{width:'50px'},anchor:'bottom',open:drawerOpen,onClose:handleDrawerClose,children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(IconButton,{style:{position:'absolute',top:'5px',right:'0'},onClick:handleDrawerClose,children:/*#__PURE__*/_jsx(CloseIcon,{})}),/*#__PURE__*/_jsx(\"b\",{style:{textAlign:'center'},children:\"Fliter\"}),/*#__PURE__*/_jsx(Divider,{style:{marginTop:'20px'}}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'10px'},children:/*#__PURE__*/_jsx(SideFilter,{onDistanceChange:function onDistanceChange(dist){return setDistance(dist);},onTimeFromChange:function onTimeFromChange(time){return setFromTime(time);},onTimeToChange:function onTimeToChange(time){setToTime(time);},onTitleSearch:function onTitleSearch(title){return setTitleSearch(title);},onShowFuture:function onShowFuture(showFuture){return setShowFuture(showFuture);},onShowMine:function onShowMine(showMine){return setShowMine(showMine);},onCapacityChange:function onCapacityChange(range){return setCapacity(range);},onTagsChange:function onTagsChange(tags){return setTags(tags);},onLevelChange:function onLevelChange(level){return setActivityLevel(level);}})})]}),/*#__PURE__*/_jsx(AddButton,{onClick:onClickAddButton}),/*#__PURE__*/_jsx(Popup,{title:\"Legg til aktivitet\",openPopup:openPopup,setOpenPopup:setOpenPopup,maxWidth:\"md\",children:/*#__PURE__*/_jsx(ActivityForm,{openPopup:openPopup,setOpenPopup:setOpenPopup})})]}),/*#__PURE__*/_jsx(ActivityGrid,{register:register,unRegister:unRegister,deleteActivity:function deleteActivity(id){return _deleteActivity(id);},activities:currentActivities})]})});};return/*#__PURE__*/_jsx(\"div\",{children:mobileView?displayMobile():displayDesktop()});};export default Activities;","map":{"version":3,"sources":["/Users/olelokken/DEV/gidd/client/src/containers/Activities.tsx"],"names":["React","useContext","useEffect","useState","ActivityForm","styled","SideFilter","SortMenu","ActivityGrid","Popup","AddButton","Drawer","Button","IconButton","Divider","CloseIcon","FilterFunctions","axios","UserContext","SortFunctions","config","Container","div","AddAndSort","View","Activities","user","mobileView","drawerOpen","state","setState","activities","setActivities","currentActivities","setCurrentActivities","openPopup","setOpenPopup","titleSearch","setTitleSearch","showMine","setShowMine","showFuture","setShowFuture","distance","setDistance","Date","fromTime","setFromTime","toTime","setToTime","capacity","setCapacity","tags","setTags","Low","Medium","High","activityLevel","setActivityLevel","location","setLocation","sortValue","setSortValue","register","activityId","console","log","Promise","resolve","post","userId","then","loadActivities","unRegister","delete","filteredActivities","titleFilter","showMyActivities","showFutureActivities","changeCapacity","dateToFilter","dateFromFilter","activityLevelFilter","tagFilter","distanceFilter","setResponsiveness","window","innerWidth","prevState","addEventListener","setCoordinates","onClickAddButton","deleteActivity","id","fetch","process","env","REACT_APP_GEOLOCATION_KEY","response","json","data","latitude","longitude","lat","lng","reverse","get","localStorage","getItem","catch","error","sortert","comingSort","distanceSort","capacitySort","activityLevelSort","displayDesktop","width","dist","time","title","level","range","val","displayMobile","handleDrawerOpen","handleDrawerClose","border","marginTop","anchor","open","onClose","position","top","right","textAlign","padding"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport ActivityForm from '../components/ActivityComponents/ActivityForm';\nimport styled from 'styled-components';\nimport SideFilter from '../components/FilterComponents/SideFilter';\nimport SortMenu from '../components/SortingComponents/SortMenu';\nimport ActivityResponse from '../interfaces/ActivityResponse';\nimport ActivityGrid from '../components/ActivityComponents/ActivityGrid';\nimport Popup from '../components/Popup';\nimport AddButton from '../components/ActivityComponents/AddButton';\nimport { Drawer, Button } from '@material-ui/core';\nimport IconButton from '@material-ui/core/IconButton';\nimport Divider from '@material-ui/core/Divider';\nimport CloseIcon from '@material-ui/icons/Close';\nimport { FilterFunctions } from '../components/FilterComponents/FilterFunctions';\nimport axios from '../Axios';\nimport ActivityLevels from '../interfaces/ActivityLevels';\nimport { UserContext } from '../UserContext';\nimport DefaultCenter from '../interfaces/DefaultCenter';\nimport { SortFunctions } from '../components/SortingComponents/SortingFunctions';\nimport config from '../Config';\n\n\nconst Container = styled.div`\n    display: flex;\n    margin-left: 10px;\n    width: 100%;\n`;\n\nconst AddAndSort = styled.div`\n    display: flex;\n    justify-content: space-between;\n\n    @media only screen and (max-width: 951px) {\n        flex-direction: column-reverse;\n    }\n`;\n\nconst View = styled.div`\n    display: flex;\n    flex-direction: column;\n    width: 75%;\n    margin-left: 3rem;\n    margin-top: 10px;\n    margin-right: 3rem;\n`;\n\nconst Activities = () => {\n    const { user } = useContext(UserContext);\n    const [state, setState] = useState({\n        mobileView: false,\n        drawerOpen: false,\n    });\n    const [activities, setActivities] = useState<ActivityResponse[]>([]);\n    const [currentActivities, setCurrentActivities] = useState<\n        ActivityResponse[]\n    >([]);\n    const [openPopup, setOpenPopup] = useState<boolean>(false);\n    const [titleSearch, setTitleSearch] = useState<string>('');\n    const [showMine, setShowMine] = useState<boolean>(false);\n    const [showFuture, setShowFuture] = useState<boolean>(false);\n    const [distance, setDistance] = useState<number>();\n    const [fromTime, setFromTime] = useState<Date>(new Date());\n    const [toTime, setToTime] = useState<Date>(new Date());\n    const [capacity, setCapacity] = useState<number[]>([0, 20]);\n    const [tags, setTags] = useState<string[]>();\n    const [activityLevel, setActivityLevel] = useState<ActivityLevels>({\n        Low: true,\n        Medium: true,\n        High: true,\n    });\n    const [location, setLocation] = useState<DefaultCenter>();\n    const [sortValue, setSortValue] = useState<number>(-1);\n\n    const register = (activityId: number): Promise<void> => {\n        console.log(activityId + ' ' + user);\n        return new Promise((resolve) => {\n            axios\n                .post('/user/activity', {\n                    userId: user,\n                    activityId: activityId,\n                }, config)\n                .then(() => loadActivities());\n            resolve();\n        });\n    };\n\n    const unRegister = (activityId: number): Promise<void> => {\n        return new Promise((resolve) => {\n            axios\n                .delete(`/user/${user}/activity/${activityId}`, config)\n                .then(() => loadActivities());\n            resolve();\n        });\n    };\n\n    useEffect(() => {\n        if (activities) {\n            setCurrentActivities(activities);\n            let filteredActivities = FilterFunctions.titleFilter(\n                activities,\n                titleSearch\n            );\n            filteredActivities = FilterFunctions.showMyActivities(\n                filteredActivities,\n                showMine,\n                user\n            );\n            filteredActivities = FilterFunctions.showFutureActivities(\n                filteredActivities,\n                showFuture\n            );\n            filteredActivities = FilterFunctions.changeCapacity(\n                filteredActivities,\n                capacity\n            );\n            filteredActivities = FilterFunctions.dateToFilter(\n                filteredActivities,\n                new Date(toTime)\n            );\n            filteredActivities = FilterFunctions.dateFromFilter(\n                filteredActivities,\n                new Date(fromTime)\n            );\n            filteredActivities = FilterFunctions.activityLevelFilter(\n                filteredActivities,\n                activityLevel\n            );\n            filteredActivities = FilterFunctions.tagFilter(\n                filteredActivities,\n                tags\n            );\n            filteredActivities = FilterFunctions.distanceFilter(\n                filteredActivities,\n                distance,\n                location\n            );\n            setCurrentActivities(filteredActivities);\n        }\n    }, [\n        titleSearch,\n        activities,\n        showFuture,\n        showMine,\n        capacity,\n        fromTime,\n        toTime,\n        activityLevel,\n        tags,\n        distance,\n    ]);\n\n    const { mobileView, drawerOpen } = state;\n\n    useEffect(() => {\n        const setResponsiveness = () => {\n            return window.innerWidth < 951\n                ? setState((prevState) => ({ ...prevState, mobileView: true }))\n                : setState((prevState) => ({\n                      ...prevState,\n                      mobileView: false,\n                  }));\n        };\n        setResponsiveness();\n        window.addEventListener('resize', () => setResponsiveness());\n        setCoordinates();\n    }, []);\n\n    const onClickAddButton = () => {\n        setOpenPopup(!openPopup);\n    };\n\n    const deleteActivity = (id: number) => {\n        axios.delete(`/activity/${id}`, config).then(loadActivities);\n    };\n\n    const setCoordinates = () => {\n        fetch(\n            `https://geolocation-db.com/json/${process.env.REACT_APP_GEOLOCATION_KEY}`\n        )\n            .then((response) => response.json())\n            .then((data) => {\n                if (data) {\n                    const latitude: number = data.latitude;\n                    const longitude: number = data.longitude;\n                    console.log(latitude + ', ' + longitude);\n                    setLocation({ lat: latitude, lng: longitude });\n                }\n            });\n    };\n\n    const reverse = () => {\n        setCurrentActivities([...currentActivities].reverse());\n    };\n\n    const loadActivities = () => {\n        axios\n            .get(`/activity?userId=${localStorage.getItem('userID')}`)\n            .then((response) => {\n                response.data;\n                setActivities(response.data['activities']);\n            })\n            .catch((error) => console.log(error));\n    };\n\n    useEffect(() => {\n        if (sortValue == 1) {\n            console.log('velger sort 1');\n            const sortert = SortFunctions.comingSort(currentActivities);\n            setCurrentActivities(sortert);\n        } else if (sortValue == 2) {\n            console.log('velger sort 2');\n            const sortert = SortFunctions.distanceSort(\n                currentActivities,\n                location\n            );\n            setCurrentActivities(sortert);\n        } else if (sortValue == 3) {\n            console.log('velger sort 3');\n            const sortert = SortFunctions.capacitySort(currentActivities);\n            setCurrentActivities(sortert);\n        } else if (sortValue == 4) {\n            console.log('velger sort 4');\n            const sortert = SortFunctions.activityLevelSort(currentActivities);\n            setCurrentActivities(sortert);\n        }\n    }, [sortValue]);\n\n    useEffect(loadActivities, [openPopup]);\n\n    const displayDesktop = () => {\n        return (\n            <Container>\n                <div style={{ width: '20%' }}>\n                    <SideFilter\n                        onDistanceChange={(dist) => setDistance(dist)}\n                        onTimeFromChange={(time) => setFromTime(time)}\n                        onTimeToChange={(time) => {\n                            setToTime(time);\n                        }}\n                        onTitleSearch={(title) => setTitleSearch(title)}\n                        onLevelChange={(level) => setActivityLevel(level)}\n                        onShowFuture={(showFuture) => setShowFuture(showFuture)}\n                        onShowMine={(showMine) => setShowMine(showMine)}\n                        onCapacityChange={(range) => setCapacity(range)}\n                        onTagsChange={(tags) => setTags(tags)}\n                    ></SideFilter>\n                </div>\n                <View>\n                    <AddAndSort>\n                        <SortMenu\n                            onSortChange={(val) => {\n                                setSortValue(val);\n                            }}\n                        >\n                            <Button onClick={reverse}>\n                                Reverser nåværende liste\n                            </Button>\n                        </SortMenu>\n                        <AddButton onClick={onClickAddButton}></AddButton>\n                        <Popup\n                            title=\"Legg til aktivitet\"\n                            openPopup={openPopup}\n                            setOpenPopup={setOpenPopup}\n                            maxWidth=\"lg\"\n                        >\n                            <ActivityForm\n                                openPopup={openPopup}\n                                setOpenPopup={setOpenPopup}\n                            />\n                        </Popup>\n                    </AddAndSort>\n                    <ActivityGrid\n                        register={register}\n                        unRegister={unRegister}\n                        deleteActivity={(id) => deleteActivity(id)}\n                        activities={currentActivities}\n                    ></ActivityGrid>\n                </View>\n            </Container>\n        );\n    };\n\n    const displayMobile = () => {\n        const handleDrawerOpen = () =>\n            setState((prevState) => ({ ...prevState, drawerOpen: true }));\n\n        const handleDrawerClose = () =>\n            setState((prevState) => ({ ...prevState, drawerOpen: false }));\n        return (\n            <Container>\n                <View>\n                    <AddAndSort>\n                        <SortMenu onSortChange={(val) => setSortValue(val)}>\n                            <Button onClick={reverse}>\n                                Reverser nåværende liste\n                            </Button>\n                        </SortMenu>\n                        <Button\n                            style={{\n                                border: '1px solid lightgrey',\n                                marginTop: '5px',\n                            }}\n                            onClick={handleDrawerOpen}\n                        >\n                            Filtrer søk\n                        </Button>\n                        <Drawer\n                            style={{ width: '50px' }}\n                            {...{\n                                anchor: 'bottom',\n                                open: drawerOpen,\n                                onClose: handleDrawerClose,\n                            }}\n                        >\n                            <br />\n                            <IconButton\n                                style={{\n                                    position: 'absolute',\n                                    top: '5px',\n                                    right: '0',\n                                }}\n                                onClick={handleDrawerClose}\n                            >\n                                <CloseIcon />\n                            </IconButton>\n                            <b style={{ textAlign: 'center' }}>Fliter</b>\n                            <Divider\n                                style={{\n                                    marginTop: '20px',\n                                }}\n                            />\n                            <div style={{ padding: '10px' }}>\n                                <SideFilter\n                                    onDistanceChange={(dist) =>\n                                        setDistance(dist)\n                                    }\n                                    onTimeFromChange={(time) =>\n                                        setFromTime(time)\n                                    }\n                                    onTimeToChange={(time) => {\n                                        setToTime(time);\n                                    }}\n                                    onTitleSearch={(title) =>\n                                        setTitleSearch(title)\n                                    }\n                                    onShowFuture={(showFuture) =>\n                                        setShowFuture(showFuture)\n                                    }\n                                    onShowMine={(showMine) =>\n                                        setShowMine(showMine)\n                                    }\n                                    onCapacityChange={(range) =>\n                                        setCapacity(range)\n                                    }\n                                    onTagsChange={(tags) => setTags(tags)}\n                                    onLevelChange={(level) =>\n                                        setActivityLevel(level)\n                                    }\n                                ></SideFilter>\n                            </div>\n                        </Drawer>\n                        <AddButton onClick={onClickAddButton}></AddButton>\n                        <Popup\n                            title=\"Legg til aktivitet\"\n                            openPopup={openPopup}\n                            setOpenPopup={setOpenPopup}\n                            maxWidth=\"md\"\n                        >\n                            <ActivityForm\n                                openPopup={openPopup}\n                                setOpenPopup={setOpenPopup}\n                            />\n                        </Popup>\n                    </AddAndSort>\n                    <ActivityGrid\n                        register={register}\n                        unRegister={unRegister}\n                        deleteActivity={(id) => deleteActivity(id)}\n                        activities={currentActivities}\n                    ></ActivityGrid>\n                </View>\n            </Container>\n        );\n    };\n\n    return <div>{mobileView ? displayMobile() : displayDesktop()}</div>;\n};\n\nexport default Activities;\n"]},"metadata":{},"sourceType":"module"}